Soundscape Data Model: Markers, Waypoints, and Reference Entities


This document clarifies the internal data model used for saved locations in Soundscape, including the relationship between Markers, Waypoints, and the underlying class, ReferenceEntity.

It also addresses terminology discrepancies between the user interface and the underlying codebase, with the goal of guiding future development, feature planning, and documentation.


- Terminology Mapping

| Concept (UI)       | Class Name (Code)     | Stored in Realm? | Shown in UI? | Notes |
|--------------------|-----------------------|------------------|--------------|-------|
| Marker  	     | `ReferenceEntity`     | Yes              | Yes	       | User-created location with name, coordinates, etc.|
| Waypoint 	     | `RouteWaypoint`       | Yes              | No           | Points in a route; references a `ReferenceEntity`|
| **Temporary Point**| `ReferenceEntity`with`isTemp = true` 	|Yes| No       | Used for beacons or ephemeral navigation targets |
| **ReferenceEntity**| `ReferenceEntity`     | Yes       	| Indirect     |Base class for all saved locations (internal term only) |


- Marker

- A Marker is a saved location explicitly created by the user.
- Implemented via the `ReferenceEntity` class.
- May include:
  - `nickname` (name)
  - `estimatedAddress`
  - `annotation`
  - GPS coordinates
- `isTemp = false` for persistent markers.
- Markers appear in the global UI list for easy access.

- Waypoint

- A Waypoint is a point used in a user-defined route.
- Represented by the `RouteWaypoint` class.
- Each waypoint includes:
  - A reference to a marker (`markerId`)
  - Its position in the route (`index`)
- Types:
  While waypoints may:
- Use an existing marker (`ReferenceEntity`)  
- Or originate from a temporary or imported location  

They should all behave the same way, regardless of origin:

- If a waypoint was created using a marker, and the marker is later deleted, the waypoint should continue to behave like an independently defined route point.



-Temporary ReferenceEntity

- Created dynamically for temporary use, such as audio beacons or ephemeral navigation targets.
- `isTemp = true`
- These are **not shown** in the markers list and are not considered persistent.
- They may overlap spatially with real markers but are treated as distinct.

-Terminology Note

The class `ReferenceEntity` is a legacy term from early versions of Soundscape (prior to 2020), when the app referred to saved locations as “reference points.”

- Today, `ReferenceEntity` = Marker (in user-facing language)
- We recommend **consistently using "Marker"** in the UI, documentation, and code comments
- If necessary, consider aliasing or renaming in the future to avoid confusion



-Marker-Waypoint Relationship Rules 

- Waypoints created from markers retain a link to the original marker.
- Waypoints created on the fly are valid route points even if no marker was involved.
- If a marker is deleted, any waypoint at the same location should continue to function normally 
- If a waypoint is deleted from a route, it does **not affect** the corresponding marker, if any.
- The user may optionally choose to “Save Waypoint as Marker” to add it to their global markers list.

